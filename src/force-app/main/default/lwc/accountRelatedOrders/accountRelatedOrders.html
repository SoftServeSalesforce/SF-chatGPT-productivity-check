<template>
    <lightning-card title="Account Related Orders">
        <template lwc:if={orders}>
          <div class="slds-m-around_medium">
            <div>
                <button onclick={goToPreviousPage} disabled={isFirstPage}>Previous</button>
                <button onclick={goToNextPage} disabled={isLastPage}>Next</button>
                <span>Page: {currentPage} of {totalPages}</span>
                <lightning-combobox name="pageSize"
                        label="Select Page Size"
                        value={pageSize}
                        options={pageSizeOptions}
                        onchange={handlePageSizeChange}>
    </lightning-combobox>
              </div>
            <div class="slds-m-bottom_medium">
                <lightning-button variant="brand" label="Activate" title="Activate" onclick={handleActivateButtonSelected} disabled={noDraftSelected}></lightning-button>
                <lightning-button variant="brand" label="Mark as Shipped" title="Mark as Shipped" onclick={handleMarkAsShippedButtonSelected} disabled={noActivatedSelected}></lightning-button>
                <lightning-button variant="brand" label="Refresh" title="Refresh" onclick={handleRefresh}></lightning-button>
            </div>
            <table aria-multiselectable="true" class="slds-table_bordered" aria-label="Orders List">
                <thead>
                    <tr>
                        <th scope="col"></th> 
                        <th scope="col">Number</th>
                        <th scope="col">Date</th>
                        <th scope="col">Status</th>
                        <th scope="col">Amount</th>
                        <th scope="col">Invoice</th> 
                        <th scope="col">Actions</th> 
                    </tr>
                </thead>
                <tbody>
                    <template for:each={orders} for:item="order">
                        <tr key={order.Id}>
                            <td><input type="checkbox" data-id={order.Id} value={order.orderStatus} onchange={handleCheckboxChange}></td>
                            <td><a data-id={order.Id} onclick={handleOrderNumberClick}>{order.orderNumber}</a></td>
                            <td>{order.startDate}</td>        
                            <td><span>{order.timeInCurrentStatus}</span><span class={order.statusBadgeCSS}>{order.orderStatus}</span></td>
                            <td><lightning-formatted-number value={order.amount} format-style="currency" currency-code="USD" currency-display-as="symbol"></lightning-formatted-number></td>
                            <td>
                                <template lwc:if={order.hasInvoices}><lightning-icon data-id={order.contentDocumentId} size="small" icon-name="utility:download" alternative-text="Download Invoice" onclick={handleDownloadInvoice}></lightning-icon></template>
                                <template lwc:else></template>
                            </td>
                            <td>
                                <template lwc:if={order.orderActions.length}>
                                    <lightning-combobox data-id={order.orderIdContentDocumentId}
                                        name="Action" 
                                        options={order.orderActions}
                                        onchange={handleActionSelected} 
                                        dropdown-alignment="auto"></lightning-combobox>
                                </template>
                                <template lwc:else>No row actions available</template>
                            </td>                                    
                        </tr>
                    </template>
                </tbody>
            </table>            
          </div>
        </template>
    </lightning-card>
</template>